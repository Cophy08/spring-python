<?xml version="1.0" encoding="UTF-8"?>
<components
	xmlns="http://springpython.webfactional.com/schema/context/spring-python-context-1.0.xsd"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

	<component id="authenticationProvider" class="springpython.security.providers.InMemoryAuthenticationProvider">
		<property name="userMap">
			{
				"blueuser": ("password1", ["LABEL_BLUE"], True),
				"superuser": ("password2", ["LABEL_SHARED"], True),
				"orangeuser": ("password3", ["LABEL_ORANGE"], True),
				"multiuser": ("password4", ["LABEL_BLUE", "LABEL_ORANGE"], True)
			}
		</property>
	</component>
		
	<component id="authenticationManager" class="springpython.security.providers.AuthenticationManager">
	  <property name="authenticationProviderList">
	    <list local="authenticationProvider"/>
	  </property>
	</component>
	
	<component id="labelBasedAclVoter" class="springpython.security.vote.LabelBasedAclVoter">
		<property name="labelMap">
			{
				"LABEL_BLUE": ["blue", "blue-orange"],
				"LABEL_ORANGE": ["orange", "blue-orange"],
				"LABEL_SHARED": ["blue", "orange", "blue-orange"]
			}
		</property>
		<property name="attributeIndicatingLabeledOperation">"LABELED_OPERATION"</property>
                <property name="allowAccessIfNoAttributesAreLabeled">False</property>
	</component>        
	
	<component id="accessDecisionManager" class="springpython.security.vote.UnanimousBased">
		<property name="allowIfAllAbstainDecisions">False</property>
		<property name="accessDecisionVoterList">
			<list local="labelBasedAclVoter"/>
		</property>
	</component>
	
	<component id="securityInteceptor" class="springpython.security.intercept.MethodSecurityInterceptor">
	  <property name="validateConfigAttributes">False</property>
	  <property name="authenticationManager" local="authenticationManager"/>
	  <property name="accessDecisionManager" local="accessDecisionManager"/>
	  <property name="objectDefinitionSource">
	    	[
				("springpythontest.support.testSecurityClasses.SampleService.get.*", []),
				("springpythontest.support.testSecurityClasses.SampleService.do.*", ["LABELED_OPERATION"])
	      	]
	  </property>
	</component>
	
	<component id="targetService" class="springpythontest.support.testSecurityClasses.SampleService"/>

	<component id="sampleService" class="springpython.aop.ProxyFactoryComponent">
		<property name="target" local="targetService"/>
		<property name="interceptors">
			<list local="securityInteceptor"/>
		</property>
	</component>
	
</components>

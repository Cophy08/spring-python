<components xmlns="http://springpython.webfactional.com/schema/context/spring-python-context-1.0.xsd"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
            
    <component id="user_details_service" class="springpython.security.userdetails.InMemoryUserDetailsService">
	    <property name="user_dict">
			{
				"basichiblueuser"  : ("password1", ["ROLE_BASIC", "ASSIGNED_BLUE",   "LEVEL_HI"], True),
				"basichiorangeuser": ("password2", ["ROLE_BASIC", "ASSIGNED_ORANGE", "LEVEL_HI"], True),
				"otherhiblueuser"  : ("password3", ["ROLE_OTHER", "ASSIGNED_BLUE",   "LEVEL_HI"], True),
				"otherhiorangeuser": ("password4", ["ROLE_OTHER", "ASSIGNED_ORANGE", "LEVEL_HI"], True),
				"basicloblueuser"  : ("password5", ["ROLE_BASIC", "ASSIGNED_BLUE",   "LEVEL_LO"], True),
				"basicloorangeuser": ("password6", ["ROLE_BASIC", "ASSIGNED_ORANGE", "LEVEL_LO"], True),
				"otherloblueuser"  : ("password7", ["ROLE_OTHER", "ASSIGNED_BLUE",   "LEVEL_LO"], True),
				"otherloorangeuser": ("password8", ["ROLE_OTHER", "ASSIGNED_ORANGE", "LEVEL_LO"], True)
			}
        </property>
    </component>

    <component id="auth_provider" class="springpython.security.providers.dao.DaoAuthenticationProvider">
	    <property name="user_details_service" local="user_details_service"/>
    </component>

	<component id="auth_manager" class="springpython.security.providers.AuthenticationManager">
	  <property name="auth_providers">
	    <list local="auth_provider"/>
	  </property>
	</component>
	
	<component id="roleVoter" class="springpython.security.vote.RoleVoter"/>

	<component id="assignedVoter" class="springpython.security.vote.RoleVoter">
		<property name="role_prefix">"ASSIGNED"</property>
	</component>

	<component id="levelVoter" class="springpython.security.vote.RoleVoter">
		<property name="role_prefix">"LEVEL"</property>
	</component>

	<component id="access_decision_mgr" class="springpython.security.vote.ConsensusBased">
		<property name="allow_if_all_abstain">False</property>
		<property name="access_decision_voters">
			<list local="roleVoter"/>
			<list local="assignedVoter"/>
                        <list local="levelVoter"/>
		</property>
	</component>
	
	<component id="securityInteceptor" class="springpython.security.intercept.MethodSecurityInterceptor">
	  <property name="validate_config_attributes">False</property>
	  <property name="auth_manager" local="auth_manager"/>
	  <property name="access_decision_mgr" local="access_decision_mgr"/>
	  <property name="obj_def_source">
	    	[
			("springpythontest.support.testSecurityClasses.SampleService.do.*",["ROLE_BASIC","ASSIGNED_BLUE","LEVEL_HI"])
	      	]
	  </property>
	</component>
	
	<component id="targetService" class="springpythontest.support.testSecurityClasses.SampleService"/>
	
	<component id="sampleService" class="springpython.aop.ProxyFactoryComponent">
		<property name="target" local="targetService"/>
		<property name="interceptors">
			<list local="securityInteceptor"/>
		</property>
	</component>

	
</components>

<components xmlns="http://springpython.webfactional.com/schema/context/spring-python-context-1.0.xsd"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

        <component id="roleVoter" class="springpython.security.vote.RoleVoter">
        	<property name="role_prefix">"role"</property>
        </component>
        
        <component id="labelBasedAclVoter" class="springpython.security.vote.LabelBasedAclVoter">
        	<property name="label_dict">
        		{
        			"LABEL_BLUE": ["blue", "blue-orange"],
        			"LABEL_ORANGE": ["orange", "blue-orange"],
					"LABEL_SHARED": ["blue", "orange", "blue-orange"]
				}
			</property>
			<property name="attr_indicating_labeled_op">"LABELED_OPERATION"</property>
		</component>        
        
		<component id="dataSource" class="springpythontest.support.testSupportClasses.StubDBFactory"/>
        
        <component id="user_details_service" class="springpython.security.userdetails.dao.DatabaseUserDetailsService">
			<property name="dataSource" local="dataSource"/>
        </component>
        
		<component id="dao_provider_hiding_exceptions" class="springpython.security.providers.dao.DaoAuthenticationProvider">
			<property name="user_details_service" local="user_details_service"/>
		</component>
		
        <component id="dao_mgr_hiding_exception" class="springpython.security.providers.AuthenticationManager">
        	<property name="auth_providers">
        		<list local="dao_provider_hiding_exceptions"/>
        	</property>
        </component>
        
		<component id="dao_provider_not_hiding_exceptions" class="springpython.security.providers.dao.DaoAuthenticationProvider">
			<property name="user_details_service" local="user_details_service"/>
			<property name="hide_user_not_found_exceptions">False</property>
		</component>
		
        <component id="dao_mgr_not_hiding_exceptions" class="springpython.security.providers.AuthenticationManager">
        	<property name="auth_providers">
        		<list local="dao_provider_not_hiding_exceptions"/>
        	</property>
        </component>
        
        <component id="inMemoryUserDetailsService" class="springpython.security.userdetails.InMemoryUserDetailsService">
        	<property name="user_dict">
        		{
		        	"user1": ("password1", ["role1", "blue"], True),
		        	"user2": ("password2", ["role1", "orange"], True),
		  			"adminuser": ("password3", ["role1", "admin"], True),
		        	"disableduser": ("password4", ["role1", "blue"], False),
		        	"emptyuser": ("", [], True)
	        	}
	        </property>
        </component>
        
		<component id="inMemoryDaoAuthenticationProvider" class="springpython.security.providers.dao.DaoAuthenticationProvider">
			<property name="user_details_service" local="inMemoryUserDetailsService"/>
		</component>
		
        <component id="inMemoryDaoAuthenticationManager" class="springpython.security.providers.AuthenticationManager">
        	<property name="auth_providers">
        		<list local="inMemoryDaoAuthenticationProvider"/>
        	</property>
        </component>
        
        <component id="accessDecisionManager" class="springpython.security.vote.UnanimousBased">
        	<property name="access_decision_voters">
        		<list local="roleVoter"/>
        		<list local="labelBasedAclVoter"/>
        	</property>
        	<property name="allow_if_all_abstain">False</property>
        </component>
        
		<component id="sampleService" class="springpythontest.support.testSecurityClasses.SampleService"/>        

</components>
